<button (click)="logout()">Logout</button>

<div class="add-product-form">
  <h3>Add Product</h3>
  <input [(ngModel)]="newProduct.name" placeholder="Product name" />
  <input [(ngModel)]="newProduct.image" placeholder="Cloudinary URL of image" />
  <img
    *ngIf="newProduct.image"
    [src]="newProduct.image"
    alt="Product image"
    class="newsImage"
  />
  <input [(ngModel)]="newProduct.category" placeholder="Category" />
  <input [(ngModel)]="newProduct.quantity" type="number" placeholder="Quantity" />
  <input [(ngModel)]="newProduct.distributor" placeholder="Distributor" />
  <input [(ngModel)]="newProduct.entryDate" type="date" placeholder="Entry Date" />
  <input [(ngModel)]="newProduct.expirationDate" type="date" placeholder="Expiration Date" />
  <input [(ngModel)]="newProduct.purchasePrice" type="number" placeholder="Purchase Price" />
  <input [(ngModel)]="newProduct.salePrice" type="number" placeholder="Sale Price" />
  <input [(ngModel)]="newProduct.barcode" placeholder="Barcode" />
  <button (click)="addProduct()">Add</button>
  <p>{{ message }}</p>
</div>

<hr />

<div class="product-list">
  <h3>Product List</h3>
  <div *ngFor="let product of productsList">
    <div *ngIf="editingProductId === product.id; else viewMode">
      <input [(ngModel)]="editedProduct.name" placeholder="Product Name" />
      <input [(ngModel)]="editedProduct.image" placeholder="Cloudinary URL of image" />
      <input [(ngModel)]="editedProduct.category" placeholder="Category" />
      <input [(ngModel)]="editedProduct.quantity" type="number" placeholder="Quantity" />
      <input [(ngModel)]="editedProduct.distributor" placeholder="Distributor" />
      <input [(ngModel)]="editedProduct.entryDate" type="date" placeholder="Entry Date" />
      <input [(ngModel)]="editedProduct.expirationDate" type="date" placeholder="Expiration Date" />
      <input [(ngModel)]="editedProduct.purchasePrice" type="number" placeholder="Purchase Price" />
      <input [(ngModel)]="editedProduct.salePrice" type="number" placeholder="Sale Price" />
      <input [(ngModel)]="editedProduct.barcode" placeholder="Barcode" />
      <button (click)="saveEdit()">Save</button>
      <button (click)="cancelEdit()">Cancel</button>
    </div>

    <ng-template #viewMode>
      <h4>{{ product.name }}</h4>
      <img *ngIf="product.image" [src]="product.image" class="preview" alt="Product image" />
      <p>Category: {{ product.category }}</p>
      <p>Quantity: {{ product.quantity }}</p>
      <p>Distributor: {{ product.distributor }}</p>
      <p>Entry Date: {{ product.entryDate }} | Expiration Date: {{ product.expirationDate }}</p>
      <p>Purchase Price: {{ product.purchasePrice }} | Sale Price: {{ product.salePrice }}</p>
      <p>Barcode: {{ product.barcode }}</p>
      <button (click)="openDeleteModal(product.id!)">Delete</button>
      <button (click)="startEdit(product)">Edit</button>
    </ng-template>

  </div>
</div>

<app-confirm-modal
  *ngIf="showDeleteModal"
  [message]="'Are you sure you want to delete this product?'"
  (confirm)="confirmDelete()"
  (cancel)="cancelDelete()">
</app-confirm-modal>
